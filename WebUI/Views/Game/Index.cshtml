@model IEnumerable<NR155910155992.MemoGame.WebUI.Models.CardViewModel>

@{
    ViewData["Title"] = "Game";
    int cols = (int?)TempData.Peek("Cols") ?? 4;
}

<div class="game-container">
    <div class="game-header">
        <h1>Current Game</h1>
        <a asp-controller="Game" asp-action="Setup" class="btn btn-outline-danger">Restart</a>
    </div>

    <div class="game-board" style="grid-template-columns: repeat(@cols, 1fr);">
        @foreach (var card in Model)
        {
            bool isFaceUp = card.IsRevealed || card.IsMatched;
            string flippedClass = isFaceUp ? "is-flipped" : "";

            string imgSource = isFaceUp ? card.ImagePath : "";
            string displayStyle = isFaceUp ? "display:block;" : "display:none;";

            string clickAction = card.IsMatched ? "" : $"flipCard(this, {card.Id})";
            string cursorStyle = card.IsMatched ? "cursor: default;" : "cursor: pointer;";

            <div class="card-scene" style="@cursorStyle" onclick="@clickAction">

                <div class="card-object @flippedClass" id="card-@card.Id">

                    <div class="face front">
                        <img src="@Url.Content("~/Assets/Cards/card_backside.png")" alt="Back" />
                    </div>

                    <div class="face back">
                        <img id="img-@card.Id"
                             src="@imgSource"
                             alt="Revealed"
                             style="@displayStyle" />
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@section Styles {
    <link rel="stylesheet" href="~/css/board.scss" asp-append-version="true" />
}

<script src="~/js/board.js" asp-append-version="true"></script>